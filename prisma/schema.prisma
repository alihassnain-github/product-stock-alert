generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model alertproduct {
  id             Int                         @id @default(autoincrement())
  shop           String
  productId      String
  variantId      String
  inventoryItem  String
  threshold      Int
  alertFrequency alertproduct_alertFrequency @default(ONCE)
  isTriggered    Boolean                     @default(false)
  createdAt      DateTime                    @default(now())
  updatedAt      DateTime                    @updatedAt
  productTitle   String
  emaillog       emaillog[]

  @@index([shop, productTitle], map: "AlertProduct_shop_productTitle_idx")
}

model emaillog {
  id             Int             @id @default(autoincrement())
  shop           String
  alertProductId Int
  date           DateTime        @default(now())
  recipientEmail String
  stockLevel     Int
  status         emaillog_status
  alertproduct   alertproduct    @relation(fields: [alertProductId], references: [id], onDelete: Cascade, map: "EmailLog_alertProductId_fkey")

  @@index([alertProductId], map: "EmailLog_alertProductId_fkey")
  @@index([shop], map: "EmailLog_shop_idx")
}

model emailtemplate {
  id        Int      @id @default(autoincrement())
  shop      String   @unique(map: "EmailTemplate_shop_key")
  subject   String
  body      String   @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model session {
  id                  String    @id
  shop                String
  state               String
  isOnline            Boolean   @default(false)
  scope               String?
  expires             DateTime?
  accessToken         String
  userId              BigInt?
  firstName           String?
  lastName            String?
  email               String?
  accountOwner        Boolean   @default(false)
  locale              String?
  collaborator        Boolean?  @default(false)
  emailVerified       Boolean?  @default(false)
  refreshToken        String?
  refreshTokenExpires DateTime?
}

model setting {
  id                  Int      @id @default(autoincrement())
  shop                String   @unique(map: "Setting_shop_key")
  enableNotifications Boolean  @default(true)
  notificationEmail   String
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

enum alertproduct_alertFrequency {
  ONCE
  ALWAYS
}

enum emaillog_status {
  SUCCESS
  FAILED
}
